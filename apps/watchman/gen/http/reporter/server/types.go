// Code generated by goa v3.4.2, DO NOT EDIT.
//
// reporter HTTP server types
//
// Command:
// $ goa gen github.com/lbryio/lbrytv/apps/watchman/design -o apps/watchman

package server

import (
	"unicode/utf8"

	reporter "github.com/lbryio/lbrytv/apps/watchman/gen/reporter"
	goa "goa.design/goa/v3/pkg"
)

// AddRequestBody is the type of the "reporter" service "add" endpoint HTTP
// request body.
type AddRequestBody struct {
	// LBRY URL
	URL *string `form:"url,omitempty" json:"url,omitempty" xml:"url,omitempty"`
	// Current playback report stream position, ms
	Position *int32 `form:"position,omitempty" json:"position,omitempty" xml:"position,omitempty"`
	// Relative stream position, pct, 0â€”100
	RelPosition *int32 `form:"rel_position,omitempty" json:"rel_position,omitempty" xml:"rel_position,omitempty"`
	// Buffering events count
	BufCount *int32 `form:"buf_count,omitempty" json:"buf_count,omitempty" xml:"buf_count,omitempty"`
	// Buffering events total duration, ms
	BufDuration *int32 `form:"buf_duration,omitempty" json:"buf_duration,omitempty" xml:"buf_duration,omitempty"`
	// Video format
	Format *string `form:"format,omitempty" json:"format,omitempty" xml:"format,omitempty"`
	// Player server name
	Player *string `form:"player,omitempty" json:"player,omitempty" xml:"player,omitempty"`
	// Unique client ID
	Client *string `form:"client,omitempty" json:"client,omitempty" xml:"client,omitempty"`
	// Client download rate, bit/s
	ClientRate *int32 `form:"client_rate,omitempty" json:"client_rate,omitempty" xml:"client_rate,omitempty"`
	// Client device
	Device *string `form:"device,omitempty" json:"device,omitempty" xml:"device,omitempty"`
	// Timestamp
	T *string `form:"t,omitempty" json:"t,omitempty" xml:"t,omitempty"`
}

// NewAddPlaybackReport builds a reporter service add endpoint payload.
func NewAddPlaybackReport(body *AddRequestBody) *reporter.PlaybackReport {
	v := &reporter.PlaybackReport{
		URL:         *body.URL,
		Position:    *body.Position,
		RelPosition: *body.RelPosition,
		BufCount:    *body.BufCount,
		BufDuration: *body.BufDuration,
		Format:      *body.Format,
		Player:      *body.Player,
		Client:      *body.Client,
		ClientRate:  body.ClientRate,
		Device:      *body.Device,
		T:           body.T,
	}

	return v
}

// ValidateAddRequestBody runs the validations defined on AddRequestBody
func ValidateAddRequestBody(body *AddRequestBody) (err error) {
	if body.URL == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("url", "body"))
	}
	if body.Position == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("position", "body"))
	}
	if body.RelPosition == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("rel_position", "body"))
	}
	if body.BufCount == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("buf_count", "body"))
	}
	if body.BufDuration == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("buf_duration", "body"))
	}
	if body.Format == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("format", "body"))
	}
	if body.Player == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("player", "body"))
	}
	if body.Client == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("client", "body"))
	}
	if body.Device == nil {
		err = goa.MergeErrors(err, goa.MissingFieldError("device", "body"))
	}
	if body.URL != nil {
		if utf8.RuneCountInString(*body.URL) > 512 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.url", *body.URL, utf8.RuneCountInString(*body.URL), 512, false))
		}
	}
	if body.Position != nil {
		if *body.Position < 0 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.position", *body.Position, 0, true))
		}
	}
	if body.RelPosition != nil {
		if *body.RelPosition < 0 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.rel_position", *body.RelPosition, 0, true))
		}
	}
	if body.RelPosition != nil {
		if *body.RelPosition > 100 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.rel_position", *body.RelPosition, 100, false))
		}
	}
	if body.BufCount != nil {
		if *body.BufCount < 0 {
			err = goa.MergeErrors(err, goa.InvalidRangeError("body.buf_count", *body.BufCount, 0, true))
		}
	}
	if body.Format != nil {
		if !(*body.Format == "std" || *body.Format == "hls") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.format", *body.Format, []interface{}{"std", "hls"}))
		}
	}
	if body.Player != nil {
		if utf8.RuneCountInString(*body.Player) > 64 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.player", *body.Player, utf8.RuneCountInString(*body.Player), 64, false))
		}
	}
	if body.Client != nil {
		if utf8.RuneCountInString(*body.Client) > 64 {
			err = goa.MergeErrors(err, goa.InvalidLengthError("body.client", *body.Client, utf8.RuneCountInString(*body.Client), 64, false))
		}
	}
	if body.Device != nil {
		if !(*body.Device == "ios" || *body.Device == "adr" || *body.Device == "web") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.device", *body.Device, []interface{}{"ios", "adr", "web"}))
		}
	}
	if body.T != nil {
		err = goa.MergeErrors(err, goa.ValidateFormat("body.t", *body.T, goa.FormatRFC1123))
	}
	return
}
